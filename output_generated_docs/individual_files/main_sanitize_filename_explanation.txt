File: D:\code_doc_generator\src\main.py
Type: function
Name: sanitize_filename
------------------------------

这个名为 `sanitize_filename` 的 Python 函数用于清理字符串，使其适合作为文件名的一部分。以下是详细解释：

### 目的
将任意输入字符串处理成安全、合法的文件名部分，主要功能包括：
1. 移除可能引发路径问题的字符（如路径分隔符）
2. 只保留安全的字符集（字母数字和少数特殊字符）
3. 防止文件名过长
4. 规范化空格处理

### 输入
- `name_part: str`：需要被处理的原始字符串（可以是任何类型，但会被转为字符串）

### 输出
- `str`：处理后的安全字符串，适合作为文件名部分

### 主要行为
1. **空值处理**：如果输入为空，直接返回空字符串
2. **类型转换**：确保输入被转为字符串类型
3. **路径分隔符替换**：将系统路径分隔符（如 `/` 或 `\`）替换为下划线 `_`
4. **字符过滤**：只保留以下字符：
   - 字母数字（`isalnum()`）
   - 空格、点号（`.`）、下划线（`_`）、中横线（`-`）
5. **长度限制**：截断字符串至前60个字符
6. **空格处理**：将所有剩余空格替换为下划线

### 示例
输入：`"My Document: 2023/Report.txt"`  
处理过程：
1. 替换 `/` → `_`
2. 过滤 `:` → 移除
3. 截断长度（假设无需截断）
4. 替换空格 → `_`  
输出：`"My_Document_2023_Report.txt"`

### 注意事项
- 不处理文件系统保留名称（如 `CON`、`NUL` 等）
- 可能生成空字符串（如果输入不含有效字符）
- 点号（`.`）被保留，可能在某些系统中表示文件扩展名