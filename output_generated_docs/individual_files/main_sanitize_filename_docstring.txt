File: D:\code_doc_generator\src\main.py
Type: function
Name: sanitize_filename
------------------------------

"""
def sanitize_filename(name_part: str) -> str:
    """Cleans a string to make it suitable as a filename component.
    
    Processes the input string by removing or replacing unsafe/inappropriate characters.
    Converts non-string inputs to strings, replaces path separators with underscores,
    and removes all characters except alphanumerics, spaces, dots, underscores and hyphens.
    Also truncates the result to 60 characters and replaces spaces with underscores.

    Args:
        name_part: Input string to be sanitized. Will be converted to string if not already.

    Returns:
        Sanitized string safe for use as a filename component. Returns empty string if input
        is empty. Result is truncated to 60 characters with spaces replaced by underscores.
    """
    if not name_part:
        return ""
    name_part = str(name_part) # 确保是字符串
    # 替换路径分隔符，移除不期望的字符
    name_part = name_part.replace(os.path.sep, '_')
    # 只保留字母数字、空格、点、下划线、中横线
    valid_chars = "".join(c for c in name_part if c.isalnum() or c in (' ', '.', '_', '-')).strip()
    # 避免文件名过长，并替换空格为下划线
    return valid_chars[:60].replace(' ', '_')
"""